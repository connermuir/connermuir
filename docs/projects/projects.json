[
  {
    "path": "projects/kelp_app/",
    "title": "Santa Barbara Kelp Forest Dynamics - Shiny App",
    "description": "This shiny app uses data collected by the SBC LTER and provides visualizations and summary figures indicating different kelp forest dynamics in the Santa Barbara region.",
    "author": [
      {
        "name": "Conner Smith",
        "url": {}
      }
    ],
    "date": "2022-03-29",
    "categories": [],
    "contents": "\r\n\r\n\r\n\r\nSource: Acccess the App on the Shiny Server\r\nKelp forests throughout California are facing multiple threats due to climate change. Increasing ocean temperatures, extreme marine heat waves, loss of predators and subsequent overgrazing by purple urchins put kelp forests at risk and imperill the multitude of species that depend on them. This app seeks to visualize the key factors influencing kelp forest health in Santa Barbara.\r\nAcklowledgments: All data included in this app is collected and managed by the Santa Barbara Coastal Long Term Ecological Research station (LTER).\r\n\r\n\r\n\r\n",
    "preview": {},
    "last_modified": "2022-03-30T09:38:34-07:00",
    "input_file": "kelp_app.knit.md"
  },
  {
    "path": "projects/dune_analysis/",
    "title": "Text Analysis of Dune",
    "description": "A text analysis exploring common word use and sentiment across the three major sections of Frank Herbert's novel, Dune.",
    "author": [
      {
        "name": "Conner Smith",
        "url": {}
      }
    ],
    "date": "2022-03-06",
    "categories": [],
    "contents": "\r\n\r\n\r\nshow\r\n\r\nknitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)\r\n\r\nlibrary(tidyverse)\r\nlibrary(here)\r\nlibrary(janitor)\r\nlibrary(tidytext)\r\nlibrary(textdata)\r\nlibrary(pdftools)\r\nlibrary(ggwordcloud)\r\nlibrary(thematic)\r\nlibrary(scales)\r\nlibrary(knitr)\r\n\r\n\r\n\r\nOverview\r\n\r\n\r\nshow\r\n\r\ninclude_graphics(here(\"_projects\", \"dune_analysis\",'dune.jpg'))\r\n\r\n\r\n\r\n\r\nThis short study performs a text analysis on Frank Herbert’s Science Fiction masterpiece, Dune. The book was first published in 1965 and follows the journey of Paul Atreides as he transitions from the gifted son of a powerful duke to the ruler of the fremen on Arakis and his conquest over the Harkonnens and the Emperor’s Sardukar army. Dune is world-building at its finest and is full of vivid imagery surrounding the desert planet of Arakis and the ecological-oriented culture of its native people, the Fremen. Dune provides lessons for a fractured world and insight into themes of power, extractive production, and environmental management.\r\nReference: Herbert, Frank. Dune, New York, NY: Chilton Books, 1965.\r\n\r\n\r\nshow\r\n\r\n# Download Dune PDF\r\n\r\ndune <- pdf_text(here(\"_projects\", \"dune_analysis\", 'data', 'dune.pdf'))\r\n\r\n\r\n\r\nAnalysis\r\nThis analysis will look at the msot common words used across the three books in Dune:\r\n“Book 1: Dune”\r\n“Book 2: Muad’Dib”\r\n“Book 3: The Prophet”\r\n\r\n\r\nshow\r\n\r\n# Convert into a data frame \r\n\r\ndune_lines <- data.frame(dune) %>% \r\n  mutate(page = 1:n()) %>%\r\n  mutate(text_full = str_split(dune, pattern = '\\\\n')) %>% \r\n  unnest(text_full) %>% \r\n  mutate(text_full = str_trim(text_full)) \r\n\r\ndune_books <- dune_lines %>% \r\n  slice(-(1:120), -(18344:20266)) %>% # Getting rid of opening sections \r\n  mutate(book = ifelse(str_detect(text_full, \"Book\"), text_full, NA)) %>% \r\n  fill(book, .direction = 'down') %>% \r\n  separate(col = book, into = c(\"book\", \"no\"), sep = \" \") %>% \r\n  mutate(no = case_when(no == 'One' ~ \"1\",\r\n                        no == 'Two' ~ \"2\",\r\n                        no == 'Three' ~ \"3\")) %>%\r\n  mutate(no = as.numeric(no)) %>% \r\n  drop_na() # a few NA values made it through the filtering\r\n\r\n# Now we have the book numbers in the data frame \r\n\r\n\r\n\r\nWord Counts\r\nThis tab looks at the most common words used across the three books of Dune including both a graph of the top 10 words and a word cloud shwoing the 100 msot common works in the second book.\r\n\r\n\r\nshow\r\n\r\ndune_words <- dune_books %>% \r\n  unnest_tokens(word, text_full) %>% \r\n  select(-dune) %>%\r\n  anti_join(stop_words, by = 'word')\r\n\r\n# Articles and filler words removed \r\n\r\ndune_wordcount <- dune_words %>% \r\n  count(no, word)\r\n\r\ntop_10_words <- dune_wordcount %>% \r\n  group_by(no) %>% \r\n  arrange(-n) %>% \r\n  slice(1:10) %>%\r\n  ungroup() %>% \r\n  mutate(word = fct_reorder(word, n)) \r\n\r\n\r\n\r\nFigure 1: Top 10 Word Count by Book\r\n\r\n\r\nshow\r\n\r\n# Create a bar graph with a \"Dune\" gradient\r\n\r\n\r\nbook_names <- as_labeller(c('1' = 'Book 1: Dune', '2'=\"Book 2: Muad'dib\", '3'=\"Book 3: The Prophet\"))\r\n  \r\n  ggplot(data = top_10_words, aes(x = n, y = word, fill = n)) +\r\n  geom_bar(stat = \"identity\") +\r\n  scale_fill_gradient(\"Count\", low = \"gold2\", high = \"sienna3\") +\r\n  facet_wrap( ~no, scales = \"free\", labeller = book_names) +\r\n  theme(strip.background = element_rect(fill = \"sienna\")) +\r\n  theme(panel.background = element_blank(),\r\n        panel.grid = element_line(color = \"khaki\")) +\r\n  theme(plot.caption = element_text(hjust = 0, face = \"bold.italic\"))+\r\n  labs(y = \"Word\", x = \"Count\", caption = \"Top 10 words across the three primary books of Dune\")\r\n\r\n\r\n\r\n\r\nWe see from this that the character names are the most common words across all three books of Dune. Unsurprisingly, words like “water” and “sand” are among the most common to occur as well. This fits with the prevailing environmental and ecological narratives of this book which go into great depth about human relationships with water and the desert on Arrakis. There are a few surprises here. Spice, the intoxicant that is the bedrock of the galactic economy and produced only on Arrakis, does not emerge in the top 10 words in any of the books.\r\nFigure 2: Cloud for top 100 Words in Book 2\r\n\r\n\r\nshow\r\n\r\nbook2_top100 <- dune_wordcount %>% \r\n  filter(no == 2) %>% \r\n  arrange(-n) %>% \r\n  slice(1:100)\r\n\r\n# Create a wordcloud\r\nbook2_cloud <- ggplot(data = book2_top100, aes(label = word)) +\r\n  geom_text_wordcloud(aes(color = n, size = n), shape = \"diamond\") +\r\n  scale_size_area(max_size = 10) +\r\n  scale_color_gradientn(colors = c(\"gold2\", \"sienna3\")) +\r\n  theme_minimal()\r\n\r\nbook2_cloud\r\n\r\n\r\n\r\n\r\nThis word cloud shows a wider selection of words from the second book, “Muad’dib.” This is the name that Paul adopts as he is adopted into the Fremen clans as he and his mother, Jessica, flee persecution from the Harkonnens. Unsurprisingly, Paul is at the center of the Dune universe. Words like “spice” that don’t appear in Figure 1 begin to emerge when taking a wider cross section of the most common words.\r\nSentiment Analysis\r\nThis analysis uses the NRC lexicon to identify the primary sentiments across all three books of Dune. This lexicon was chosen for its ability to parse out specific emotional attitudes rather than a ranked and/or binary scale of negative or positive sentiments for the AFINN and Bing lexicons.\r\nData Source: Crowdsourcing a Word-Emotion Association Lexicon, Saif Mohammad and Peter Turney, Computational Intelligence, 29 (3), 436-465, 2013.\r\nFigure 3: Leading Sentiments Word Count by Book\r\n\r\n\r\nshow\r\n\r\n# Use the nrc lexiconn\r\n\r\ndune_nrc <- dune_words %>% \r\n  inner_join(get_sentiments(\"nrc\"))\r\n\r\ndune_nrc_counts <- dune_nrc %>% \r\n  count(no, sentiment) %>% \r\n  arrange(-n) %>% \r\n  mutate(sentiment = str_to_title(sentiment)) %>% \r\n  mutate(sentiment = fct_reorder(sentiment, n))\r\n  \r\n\r\n\r\nggplot(data = dune_nrc_counts, aes(x = sentiment, y = n, fill = n)) +\r\n  facet_wrap(~no) +\r\n  coord_flip() +\r\n  geom_bar(stat = \"identity\") +\r\n  scale_fill_gradient(\"Count\", low = \"gold2\", high = \"sienna3\") +\r\n  scale_y_continuous(breaks = pretty_breaks(n = 3)) +\r\n  facet_wrap( ~no, scales = \"free\", labeller = book_names) +\r\n  theme(strip.background = element_rect(fill = \"sienna\")) +\r\n  theme(panel.background = element_blank(),\r\n        panel.grid = element_line(color = \"khaki\")) +\r\n  theme(plot.caption = element_text(hjust = 0, face = \"bold.italic\"))+\r\n  labs(x = \"Sentiment\", y = \"Count\", caption = \"Leading sentiments words across the three primary books of Dune using the NRC lexiconn.\")\r\n\r\n\r\n\r\n\r\nThis figures shows an interesting pattern in sentiments across the three Dune books. At a high level, Frank Herbet appears to employ a generally steady writing tone throughout the book with minimal swings in overall sentiment from book section to book section. That being said, “Positive” and “Negative” sentiments appear to even out as the book proceeds with more “Positive” sentiment relative to “Negative” sentiment in Book 1 being focused primarily on the time before tragedy finds the Attreides family on Arrakis. “Fear” is a sentiment that seems to decline throughout the book. This could be explained by Paul’s increasing comfort in his power as the leader of the Fremen and mastery over his emotions emblemized in the Litany Against Fear:\r\n“I must not fear.Fear is the mind-killer. Fear is the little-death that brings total obliteration. I will face my fear. I will permit it to pass over me and through me.And when it has gone past, I will turn the inner eye to see its path.Where the fear has gone there will be nothing. Only I will remain.” - Frank Herbet, Dune (1965)\r\n\r\n\r\n\r\n",
    "preview": "projects/dune_analysis/dune_text_analysis_files/figure-html5/unnamed-chunk-5-1.png",
    "last_modified": "2022-03-09T08:46:56-08:00",
    "input_file": {}
  },
  {
    "path": "projects/fish_passage/",
    "title": "Willamette Falls Fish Passage Analysis",
    "description": "An analysis exploring time series data on fish passage through the Willamette Falls fish ladder from 2001 to 2010 for three species.",
    "author": [
      {
        "name": "Conner Smith",
        "url": {}
      }
    ],
    "date": "2022-03-03",
    "categories": [],
    "contents": "\r\n\r\n\r\nshow\r\n\r\nknitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)\r\n\r\nlibrary(tidyverse)\r\nlibrary(here)\r\nlibrary(janitor)\r\nlibrary(knitr)\r\nlibrary(fable)\r\nlibrary(tsibble)\r\nlibrary(feasts)\r\nlibrary(lubridate)\r\nlibrary(thematic)\r\nlibrary(cowplot)\r\nlibrary(scales)\r\n\r\n\r\n\r\nOverview\r\n\r\n\r\nshow\r\n\r\n# Read in the main data set\r\n\r\nfish <- read_csv(here(\"_projects\", \"fish_passage\",\r\n                        \"data\", \"willamette_fish_passage.csv\")) %>% \r\n  clean_names()\r\n\r\n# Adding image\r\ninclude_graphics(here(\"_projects\", \"fish_passage\", 'chinook.jpg'))\r\n\r\n\r\n\r\n\r\nSource: Corvallis Advocate\r\nThis analysis looks at fish passage data at Willamette Falls collected by the University of Washington’s Columbia Basin Research initiative. Data collection is ongoing and managed by a combination of federal, state, and tribal agencies. The tabs below include time series data, seasonal plots, and annual counts by species for fish ladder passage at Willamette Falls from 2001 to 2010.\r\nData Citation University of Washington, Columbia Basin Research. 2010. DART Adult Passage Graphics & Text. http://www.cbr.washington.edu/dart/query/adult_graph_text.\r\nAnalysis\r\nThis analysis includes three separate tabs looking at different ways of visualizing fish passage data for three target species: Coho, Jack Coho, and Steelhead. Jack Coho return to the rivers to spawn in the same year that they smolted and are significantly smaller than the regular Coho recorded in this data set.\r\nOriginal Time Series\r\nTab 1 shows the full time series of Willamette Falls fish passage counts for the three target species from 2001 to 2010.\r\n\r\n\r\nshow\r\n\r\n# Convert this to a tsibble since the 'date' column is a character\r\n\r\nfish_ts <- fish %>% \r\n  mutate(date = mdy(date)) %>% #Using 'lubridate::mdy' instead of 'tsibble::yearmonth'\r\n  as_tsibble(key = NULL, index = date) %>% \r\n  select(coho, jack_coho, steelhead) %>% #Filter for these three species\r\n  replace_na(list(coho = 0, jack_coho = 0, steelhead = 0)) %>% \r\n\r\n# want to make all fish appear in same column with 'pivot_longer'\r\n  \r\n  pivot_longer(cols = c(coho, jack_coho, steelhead),\r\n               names_to = 'fish_species',\r\n               values_to = 'passage_count') %>% #Get the names back to normal format\r\n  mutate(fish_species = case_when(fish_species == 'coho' ~ 'Coho',\r\n                   fish_species == 'jack_coho' ~ 'Jack Coho',\r\n                   fish_species == 'steelhead' ~ 'Steelhead'))\r\n\r\n\r\n\r\nFigure 1: Counts of Fish Passage for Coho, Jack Coho, and Steelhead (2001-2010)\r\n\r\n\r\nshow\r\n\r\n# Calling the wrangled data frame into a static graph \r\n\r\nggplot(data = fish_ts, aes(x = date, y = passage_count)) + \r\n  geom_line(aes(color = fish_species)) +\r\n  scale_color_manual(\"Fish Species\", \r\n                     values = c('slateblue', 'olivedrab2', 'aquamarine3')) +\r\n  labs(x = \"Date\", y = \"Passage Counts\", \r\n       caption = \"Figure 1: Time series fish passage counts for Coho, Jack Coho and Steelhead at Willamette Falls (2001 - 2010)\") +\r\n   theme(plot.caption = element_text(hjust = 0, face = \"bold.italic\")) +\r\n  theme(legend.position = \"bottom\")\r\n\r\n\r\n\r\n\r\nKey Takeaways\r\nPassage of Steelhead at Willamette Falls remains relatively consistent year to year with clear seasonal trends.\r\nPassage counts for Coho increase significantly after 2008 and are more than twice as high as Steelhead passage counts in 2010.\r\nJack Coho showed the smallest number of passages. Jack Coho are smaller than Coho and may have more difficulty passing through the fish ladder compared to older, larger Coho.\r\nSeason Plots\r\nTab 2 shows the seasonal patterns for each species across the entire time scale in order to explain some of the patterns seen in Figure 1 in Tab 1.\r\nFigure 2: Seasonal Passage Counts By Species\r\n\r\n\r\nshow\r\n\r\ncoho_plot <- fish_ts %>% \r\n  filter(fish_species == \"Coho\") %>% \r\n  gg_season(y = passage_count) +\r\n  scale_color_viridis_c() +\r\n  labs(title = \"Coho Passages\", y = \"Passage Counts\") +\r\n  theme(legend.position = \"none\") +\r\n  theme(axis.title.x = element_blank())\r\n\r\njack_plot <- fish_ts %>% \r\n  filter(fish_species == \"Jack Coho\") %>% \r\n  gg_season(y = passage_count) +\r\n  scale_color_viridis_c() +\r\n  labs(title = \"Jack Coho Passages\", y = \"Passage Counts\") +\r\n  theme(legend.position = \"none\") +\r\n  theme(axis.title.x = element_blank())\r\n\r\nsteel_plot <- fish_ts %>% \r\n  filter(fish_species == \"Steelhead\") %>% \r\n  gg_season(y = passage_count) +\r\n  scale_color_viridis_c() +\r\n  labs(title = \"Steelhead Passages\", y = \"Passage Counts\",\r\n       caption = \"Figure 2: These graphs show the seasonality of passages across the three species.\\nThe values in the legend refer to the 10-year range of data with '10' corresponding to 2010.\") +\r\n  theme(plot.caption = element_text(hjust = 0, face = \"bold.italic\")) +\r\n  theme(legend.position = \"bottom\") +\r\n  theme(axis.title.x = element_blank()) \r\n\r\nplot_grid(coho_plot,jack_plot,steel_plot,\r\n          cols = 1, nrow = 3)\r\n\r\n\r\n\r\n\r\nKey Takeaways\r\nPassages for Coho (including Jacks) are concentrated in a smaller band of months (September - November) compared to Steelhead which pass through Willamette Falls throughout the first half of the year.\r\nJack Coho have the smallest passage window, which peaks in October and likely corresponds with the spawning cycles for this species.\r\nHigher passages for Coho and Jack Coho (displayed by lines with values on the upper end of the range outlined in the legend) correspond to the increases in passage counts after 2008 displayed in Figure 1 in Tab 1.\r\nAnnual Count by Species\r\nTab 3 looks at the total annual passages for each of the three species across all data years. This differs from Tab 1, which showed daily passages.\r\n\r\n\r\nshow\r\n\r\n# This will do the same wrangling as in the time series tab but without converting to a tsibble \r\n\r\nfish_counts <- fish %>% \r\n  mutate(date = mdy(date)) %>% #lubridate\r\n  select(coho, jack_coho, steelhead, date) %>% \r\n  replace_na(list(coho = 0, jack_coho = 0, steelhead = 0)) %>%\r\n  pivot_longer(cols = c(coho, jack_coho, steelhead),\r\n               names_to = 'fish_species',\r\n               values_to = 'passage_count') %>% \r\n  mutate(fish_species = case_when(fish_species == 'coho' ~ \"Coho\",\r\n                             fish_species == 'jack_coho' ~ \"Jack Coho\",\r\n                             fish_species == 'steelhead' ~ \"Steelhead\")) %>% \r\n  \r\n  # Now we need to generate counts by year\r\n  mutate(year = year(date)) %>% \r\n  select(-date) %>% # Don;t need date anymore\r\n  group_by(year, fish_species) %>% \r\n  summarize(annual_counts = sum(passage_count))\r\n\r\n\r\n\r\nFigure 3: Annual Passage Counts by Species (2001-2010)\r\n\r\n\r\nshow\r\n\r\nggplot(data = fish_counts, aes(x = year, y = annual_count)) +\r\n  geom_line(aes(x = year, y = annual_counts, color = fish_species)) +\r\n  scale_x_continuous(breaks = pretty_breaks(n = 5)) +\r\n  scale_color_manual(\"Fish Species\",\r\n                     values = c('slateblue', 'olivedrab2', 'aquamarine3')) +\r\n  labs(x = \"Date\", y = \"Passage Counts\", \r\n       caption = \"Figure 3: Annual fish passage counts for Coho, Jack Coho, and Steelhead at Willamette Falls.\") +\r\n   theme(plot.caption = element_text(hjust = 0, face = \"bold.italic\")) +\r\n  theme(legend.position = \"bottom\")\r\n\r\n\r\n\r\n\r\nKey Takeaways\r\nAnnual counts confirm what is shown in Figure 1 in Tab 1 where more Coho are passing through Willamette Falls after 2008.\r\nSteelhead passages are higher overall on the annual level with the exception of 2019 where Coho passages surpassed the Steelhead passages.\r\nJack Coho passages were relatively consistent across the time range and generally stayed below the level of passages for adult Coho.\r\n\r\n\r\n\r\n",
    "preview": "projects/fish_passage/fish_passage_files/figure-html5/unnamed-chunk-3-1.png",
    "last_modified": "2022-03-09T16:45:34-08:00",
    "input_file": {}
  },
  {
    "path": "projects/binomial_regression/",
    "title": "Binomial Logistic Regression with Palmetto Species",
    "description": "A binomial regression using mdoels to predict palmetto species from a lsit of observed variables.",
    "author": [
      {
        "name": "Conner Smith",
        "url": {}
      }
    ],
    "date": "2022-01-27",
    "categories": [],
    "contents": "\r\n\r\n\r\nshow\r\n\r\nknitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)\r\n\r\nlibrary(tidyverse)\r\nlibrary(here)\r\nlibrary(ggbeeswarm)\r\nlibrary(broom)\r\nlibrary(caret)\r\nlibrary(AICcmodavg)\r\nlibrary(cowplot)\r\nlibrary(kableExtra)\r\nlibrary(janitor)\r\n\r\n\r\n\r\nOverview\r\nThis analysis looks at the survival, growth and biomass estimates of two dominant palmetto species of south-central Florida from 1981 - 2017. It uses binary logistic regression to predict whether a palmetto is species Serenoa repens or Sabal etonia. Data was collected by the Environmental Data Initiative.\r\nData Visualization\r\n\r\n\r\nshow\r\n\r\n# Read in the data \r\n\r\npalmetto <- read_csv(here(\"_projects\", \"binomial_regression\", \"data\", \"palmetto.csv\"))\r\n\r\n\r\n\r\nThis analysis uses binary logistic regression to test feasibility of using variables plant height (height), canopy length (length), canopy width (width), and number of green leaves (green_lvs) to classify whether a palmetto is species Serenoa repens or Sabal etonia.\r\nFigure 1: Palmetto Height and Leaf Count by Species\r\n\r\n\r\nshow\r\n\r\n# Create 2 finalized data visualizations exploring differences in height, canopy length, canopy width, and green leaves for the two species. Note: species code 1 is Serenoa repens and species code 2 is Sabal etonia. \r\n\r\npalmetto_clean <- palmetto %>% \r\n  select(year, species, height:green_lvs) %>% \r\n  drop_na() %>% \r\n  mutate(species = case_when(species == \"1\" ~ \"Serenoa repens\",\r\n                   species == \"2\" ~ \"Sabal etonia\"))\r\n\r\n#Creating summary of height to pull means for in-line code \r\n\r\npalmetto_summary <- palmetto_clean %>%\r\n  group_by(species) %>% \r\n  summarize(count = n(),\r\n            mean_height = mean(height, na.rm = TRUE),\r\n            mean_width = mean(width, na.rm = TRUE),\r\n            mean_length = mean(length, na.rm = TRUE))\r\n\r\n# Plot 1: Height beeswarm \r\n\r\nheight <- ggplot(data = palmetto_clean, aes(x = species, y = height)) +\r\n  geom_beeswarm(aes(color = species), \r\n                dodge.width = 0, cex = 0.4, size = 0.1,\r\n                show.legend = FALSE) +\r\n  geom_boxplot(fill = NA, width = 0.2, color = 'darkslategray',\r\n               outlier.color = NA) +\r\n  stat_summary(fun.y = \"mean\",\r\n               col = \"darkslategray\",\r\n               shape = 18) +\r\n  scale_color_manual(values = c(\"darkolivegreen3\", \"seagreen\")) +\r\n  theme_bw() +\r\n  labs(x = \"Species\", y = \"Height (cm)\")\r\n\r\n# Plot 2: Leaves histogram\r\n\r\nleaves <- ggplot(data = palmetto_clean, aes(x = green_lvs)) +\r\n  geom_histogram(aes(fill = species), color = \"darkslategray\",\r\n                 binwidth = 1, show.legend = FALSE) +\r\n  scale_fill_manual(values = c(\"darkolivegreen3\", \"seagreen\")) +\r\n  facet_wrap(~ species) +\r\n  theme_bw() +\r\n  labs(x = \"Green Leaves (number)\", y = \"Count\")\r\n\r\n# combine plots\r\n\r\nplots <- plot_grid(height, leaves,\r\n                   ncol = 2,\r\n                   rel_widths = c(1, 1))\r\n\r\nplot_grid(plots, ncol = 1,\r\n          rel_heights = c(0.1, 1, 0.1))\r\n\r\n\r\n\r\n\r\nFigure 1: The left graph plots palmetto height by species with the box showing the median values as well as the the 75th and 25th percentile ranges. The diamond points represent the mean values. The right plot shows the distribution of leaf number by species.\r\nThese graphs show that both species have a similar height, indicating this variable may not be significant in the model. The difference in mean height between the two species is only 2.1centimeters. The taller of the two species, Serenoa repens tend to have more green leaves and the range of leaf number is wider. Sabal etonia were more closely clustered around 3-4 leaves. This indicted that leaf number could be one of the strongest predictive variables in this model.\r\nFigure 2: Palmetto Canopy Width and Length by Species\r\n\r\n\r\nshow\r\n\r\n# Plot 1: width\r\n\r\nwidth <- ggplot(data = palmetto_clean, aes(x = species, y = width)) +\r\n  geom_jitter(aes(color = species), width = 0.3, size = 0.5,\r\n             show.legend = FALSE) +\r\n  geom_boxplot(fill = NA, width = 0.2, color = 'darkslategray',\r\n               outlier.color = NA) +\r\n  stat_summary(fun.y = \"mean\",\r\n               col = \"darkslategray\",\r\n               shape = 18) +\r\n  scale_color_manual(values = c(\"darkolivegreen3\", \"seagreen\")) +\r\n  theme_bw() +\r\n  theme(axis.title.x=element_blank(), \r\n        axis.title.y = element_text(size = 10)) +\r\n  labs(y = \"Canopy Width (cm)\")\r\n\r\n# Plot 2: Length\r\n\r\nlength <- ggplot(data = palmetto_clean, aes(x = species, y = length)) +\r\n  geom_jitter(aes(color = species), width = 0.3, size = 0.5,\r\n             show.legend = FALSE) +\r\n  geom_boxplot(fill = NA, width = 0.2, color = 'darkslategray',\r\n               outlier.color = NA) +\r\n  stat_summary(fun.y = \"mean\",\r\n               col = \"darkslategray\",\r\n               shape = 18) +\r\n  scale_color_manual(values = c(\"darkolivegreen3\", \"seagreen\")) +\r\n  theme_bw() +\r\n  theme(axis.title.x=element_blank(), \r\n        axis.title.y = element_text(size = 10)) +\r\n  labs(y = \"Canopy Length (cm)\")\r\n\r\n# combine plots\r\n\r\nplots <- plot_grid(width, length,\r\n                   ncol = 2,\r\n                   rel_widths = c(1, 1))\r\n\r\nplot_grid(plots, ncol = 1,\r\n          rel_heights = c(0.1, 1, 0.1))\r\n\r\n\r\n\r\n\r\nFigure 2: The graph shows the height and length of palmetto canopy across the two species.\r\nBoth species show similar average canopy width and length with the Sabal etonia showing higher mean values for both. For the width, the difference in means between the two species is 7.3 centimeters. The difference in average length is 23.28 centimeters. This indicates that canopy length could be a stronger determinant of species in the model compared to canopy width.\r\nModel Analysis\r\nNow knowing a few general characteristics about the two species, this analysis will build a binomial logistic regression to try and predict the species from the data.\r\n\r\n\r\nshow\r\n\r\n# Perform the analysis twice, using cross validation to compare two models.\r\n\r\npalmetto_sub <- palmetto %>% \r\n  select(year, species, height:green_lvs) %>% \r\n  mutate(species = as.factor(species)) %>% \r\n  mutate(species = fct_drop(species)) %>% \r\n  drop_na()\r\n\r\n# Note: Sabal etonia is the '0' level\r\n\r\n# Model 1: Log odds of plant type using plant height, canopy length, canopy width and green leaves as predictor variable.\r\n\r\nf1 <- species ~ height + width + length + green_lvs\r\n\r\npalmetto_blm1 <- glm(formula = f1, \r\n                    data = palmetto_sub, \r\n                    family = 'binomial')\r\n\r\n\r\n# Log odds to probability\r\n\r\nblm1_fitted <- palmetto_blm1 %>% \r\n  augment(type.predict = 'response')\r\n\r\n# Model 2: Log odds of plant type using plant height, canopy width and green leaves (i.e., drop canopy length for this model)\r\n\r\nf2 <- species ~ height + width + green_lvs\r\n\r\npalmetto_blm2 <- glm(formula = f2, \r\n                    data = palmetto_sub, \r\n                    family = 'binomial')\r\n\r\n# Log odds to probability\r\n\r\nblm2_fitted <- palmetto_blm2 %>% \r\n  augment(type.predict = 'response')\r\n\r\n# Assess the models with AICc first \r\n\r\naic <- aictab(list(palmetto_blm1, palmetto_blm2))\r\n\r\n# Model 1 has a lower corrected AIC value, indicating better fit. \r\n\r\n\r\n\r\nAn initial look at the AIC values indicate Model 1 may be a better fit. The corrected AIC value for Model 1 (5195) is lower compared to model 2 (5987). The difference in these values is large, indicating that including canopy length could be important for this model.\r\n\r\n\r\nshow\r\n\r\n# Assess the models with AICc first \r\n\r\naic <- aictab(list(palmetto_blm1, palmetto_blm2))\r\n\r\n# Model 1 has a lower corrected AIC value, indicating better fit. \r\n\r\n# Perform cross-validation with caret\r\n\r\nset.seed(123)\r\n\r\ntr_ctrl <- trainControl(method = \"repeatedcv\", \r\n                        number = 10, repeats = 10)\r\n\r\nmodel1 <- train(f1, data = palmetto_sub, \r\n                method = \"glm\", family = 'binomial',\r\n                trControl = tr_ctrl)\r\n\r\n\r\nmodel2 <- train(f2, data = palmetto_sub, \r\n                method = \"glm\", family = 'binomial',\r\n                trControl = tr_ctrl)\r\n\r\n\r\n\r\nModel 1 predicts the species of Palmetto with 91.7% percent accuracy. This is slightly higher than the 89.9% predictive accuracy of Model 2. Given the more favorable AIC value and higher predictive accuracy, this analysis will use Model 1.\r\nTable 1: This table provides a summary of the coefficients associated with the different variables used in the model. Each coefficient had a p value less than 0.001. Serenoa repens is the reference species.\r\n\r\n\r\nshow\r\n\r\n# Train the final model (model 3) on the entire data set (not the folds). \r\n\r\nfinal_model <- glm(formula = f1, \r\n                    data = palmetto_sub, \r\n                    family = 'binomial')\r\n\r\n# Use tidy to clean this up\r\n\r\ntidy_model <- tidy(final_model)\r\n\r\ntidy_model$p.value <- ifelse(tidy_model$p.value < .001, paste(\"< .001\"))\r\n\r\n# Use kable to create a table of these stats\r\n\r\nfinal_table <- tidy_model %>% \r\n  select(-statistic) %>% \r\n  mutate(term = case_when(term == '(Intercept)' ~ 'Intercept',\r\n                          term == 'height' ~ 'Height',\r\n                          term == 'width' ~ 'Width',\r\n                          term == 'length' ~ 'Length',\r\n                          term == 'green_lvs' ~ 'Green Leaves')) %>%\r\n  kable(col.names = c(\"Variable\", \"Coefficients\", \r\n                      \"Standard Error\", \"P Value\"),\r\n        digits = 3) %>% \r\n  kable_styling(bootstrap_options = \"striped\", \r\n                position = \"left\", full_width = FALSE)\r\nfinal_table\r\n\r\n\r\n\r\nVariable\r\n\r\n\r\nCoefficients\r\n\r\n\r\nStandard Error\r\n\r\n\r\nP Value\r\n\r\n\r\nIntercept\r\n\r\n\r\n3.227\r\n\r\n\r\n0.142\r\n\r\n\r\n< .001\r\n\r\n\r\nHeight\r\n\r\n\r\n-0.029\r\n\r\n\r\n0.002\r\n\r\n\r\n< .001\r\n\r\n\r\nWidth\r\n\r\n\r\n0.039\r\n\r\n\r\n0.002\r\n\r\n\r\n< .001\r\n\r\n\r\nLength\r\n\r\n\r\n0.046\r\n\r\n\r\n0.002\r\n\r\n\r\n< .001\r\n\r\n\r\nGreen Leaves\r\n\r\n\r\n-1.908\r\n\r\n\r\n0.039\r\n\r\n\r\n< .001\r\n\r\n\r\nThis table shows the coefficients associated with each variable from Model 1. These reflect differences in the characteristics visualized above. In particular, the large negative coefficient for the number of green leaves means it is less likely the species is Sabal etonia (the reference species) as the number of green leaves increases. This is confirmed in Figure 1.\r\nTable 2: This table provides a summary of the percentage of accurate predictions from Model 1 for each species. The average accuracy of the model was 92%\r\n\r\n\r\nshow\r\n\r\n# Use the fitted data set created above and establish a threshold at 50% where the model will predict species 2 above the threshold, and species 1 below the threshold. \r\n\r\nblm1_thresh <- blm1_fitted %>% \r\n  mutate(predicted = case_when(.fitted >= .5 ~ \"2\", \r\n    .fitted < .5 ~ \"1\")) %>% # Now mutate a new column to show correct/incorrect\r\n  mutate(outcome = case_when(\r\n    species == predicted ~ \"Correct\",\r\n    species != predicted ~ \"Incorrect\"))\r\n  \r\n# Create a new df to show the counts correct/incorrect\r\n\r\nthresh_summary <- blm1_thresh %>% \r\n  group_by(species, outcome) %>% \r\n  count(outcome) %>% \r\n  pivot_wider(names_from = outcome,\r\n              values_from = n) %>% \r\n  mutate(species = case_when(\r\n    species == 1 ~ \"Serenoa repens\",\r\n    species == 2 ~ \"Sabal etonia\")) %>% \r\n  column_to_rownames(var = \"species\") %>% \r\n  mutate(pct_correct = round(Correct/(Correct + Incorrect)*100, 0)) %>% \r\n  mutate(pct_correct = paste(pct_correct,\"%\", sep = ''))\r\n\r\n# Pass this new data frame into a finalized table. \r\n\r\nthresh_summary %>% \r\n  kable(col.names = c(\"Correct\", \"Incorrect\", \r\n                      \"Percent Correct\")) %>% \r\n  kable_styling(bootstrap_options = \"striped\", \r\n                position = \"left\", full_width = FALSE)\r\n\r\n\r\n\r\n\r\n\r\nCorrect\r\n\r\n\r\nIncorrect\r\n\r\n\r\nPercent Correct\r\n\r\n\r\nSerenoa repens\r\n\r\n\r\n5548\r\n\r\n\r\n564\r\n\r\n\r\n91%\r\n\r\n\r\nSabal etonia\r\n\r\n\r\n5701\r\n\r\n\r\n454\r\n\r\n\r\n93%\r\n\r\n\r\nModel 1 was more accurate in predicting Sabal etonia comapred to Serenoa repens. The model correctly predicted that a palmetto was Serenoa repens 91% of the time. The accuracy of predicting Sabal etonia was 93%. This gives the average accuracy of 92% referenced above.\r\nData Citation\r\nAbrahamson, W.G. 2019. Survival, growth and biomass estimates of two dominant palmetto species of south-central Florida from 1981 - 2017, ongoing at 5-year intervals ver 1. Environmental Data Initiative. https://doi.org/10.6073/pasta/f2f96ec76fbbd4b9db431c79a770c4d5\r\n\r\n\r\n\r\n",
    "preview": "projects/binomial_regression/binomial_regression_files/figure-html5/unnamed-chunk-2-1.png",
    "last_modified": "2022-03-09T09:11:46-08:00",
    "input_file": {}
  },
  {
    "path": "projects/sugar_maple/",
    "title": "Hubbard Brooks LTER Sugar Maple Study",
    "description": "An analysis exploring the impacts of soil treatment on sugar maple growth for trees in acid rain effected watersheds.",
    "author": [
      {
        "name": "Conner Smith",
        "url": {}
      }
    ],
    "date": "2021-12-04",
    "categories": [],
    "contents": "\r\nOverview\r\nThis analysis explores differences in growth patterns between sugar maples in acid-rain affected watersheds that have received calcium addition treatment, and those that have not. The data was collected in both 2003 and 2004 by researchers at Hubbard Brooks LTER site in New Hampshire.\r\n\r\n\r\nshow\r\n\r\n# Read in the data.\r\n\r\nmaples <- read_csv(here(\"_projects\", \"sugar_maple\", \"data\", \"maples.csv\")) \r\n\r\n\r\n\r\nAnalysis\r\nThis analysis presents summary statistics for maple growth rates between the two plot types and employs a two-sample t-test to explore if any differences in growth rates are significant.\r\nTable 1: Maple Growth Rates by Site and Year - This table provides summary statistics for maple stem length and mass. The data shows tree growth between the two study years (2003 and 2004) and larger on average stems in the treatment watershed (“W1”) compared to the reference.\r\n\r\n\r\nshow\r\n\r\n# Create a subset of the data for only stem characteristics. `group_by` year and watershed. \r\n\r\nstems <- maples %>% \r\n  select(year, watershed, stem_length, stem_dry_mass) \r\n\r\nstems_summary <- stems %>% \r\n  group_by(watershed, year) %>% \r\n  summarize(sample_size = n(),\r\n            mean_length = mean(stem_length),\r\n            sd_length = sd(stem_length),\r\n            mean_mass = mean(stem_dry_mass),\r\n            sd_mass = sd(stem_dry_mass))\r\n\r\nstems_summary %>% \r\n  kable(col.names = c(\"Watershed\", \r\n                      \"Year\", \r\n                      \"Sample Size\",\r\n                      \"Stem Length Mean(mm)\",\r\n                      \"Stem Length Standard Deviation (mm)\", \r\n                      \"Stem Mass Mean (g)\", \r\n                      \"Stem Mass Standard Deviation(g)\"), digits = 2) %>% \r\n  kable_styling(bootstrap_options = \"striped\", full_width = FALSE)\r\n\r\n\r\n\r\nWatershed\r\n\r\n\r\nYear\r\n\r\n\r\nSample Size\r\n\r\n\r\nStem Length Mean(mm)\r\n\r\n\r\nStem Length Standard Deviation (mm)\r\n\r\n\r\nStem Mass Mean (g)\r\n\r\n\r\nStem Mass Standard Deviation(g)\r\n\r\n\r\nReference\r\n\r\n\r\n2003\r\n\r\n\r\n120\r\n\r\n\r\n80.98\r\n\r\n\r\n13.94\r\n\r\n\r\n0.02\r\n\r\n\r\n0.01\r\n\r\n\r\nReference\r\n\r\n\r\n2004\r\n\r\n\r\n59\r\n\r\n\r\n85.88\r\n\r\n\r\n15.59\r\n\r\n\r\n0.07\r\n\r\n\r\n0.02\r\n\r\n\r\nW1\r\n\r\n\r\n2003\r\n\r\n\r\n120\r\n\r\n\r\n87.89\r\n\r\n\r\n14.34\r\n\r\n\r\n0.03\r\n\r\n\r\n0.01\r\n\r\n\r\nW1\r\n\r\n\r\n2004\r\n\r\n\r\n60\r\n\r\n\r\n97.52\r\n\r\n\r\n13.83\r\n\r\n\r\n0.09\r\n\r\n\r\n0.02\r\n\r\n\r\nFigure 1: Stem Dry Mass at Treatment and Reference Sites (2003)\r\n\r\n\r\nshow\r\n\r\n# Filter for only 2003 data. \r\n\r\nstems_y1 <- stems %>% \r\n  filter(year == \"2003\")\r\n\r\nggplot(data = stems_y1, aes(x = watershed, y = stem_dry_mass)) +\r\n  geom_beeswarm(aes(color = watershed), \r\n                dodge.width = 1, cex = 2, show.legend = FALSE) +\r\n  geom_boxplot(fill = NA, width = 0.2, outlier.color = NA) +\r\n  stat_summary(fun.y = \"mean\",\r\n               color = \"skyblue4\",\r\n               shape = 19) +\r\n  scale_color_manual(values = c(\"darkgoldenrod1\", \"darkorange2\")) +\r\n  theme_bw() +\r\n  labs(x = \"Watershed\", y = \"Strem Dry Mass (g)\")\r\n\r\n\r\n\r\n\r\nFigure 1: This graph shows the breakdown of stem mass in both the control (“Reference”) and treatment (“W1”) watersheds for 2003. This shows a clear increase in stem mass for the treatment plot. The boxes on the graph show the median as well as the 25th and 75th percentile mass values. The mean is marked as a single darker point.\r\n\r\n\r\nshow\r\n\r\n# Run diagnostic plots to determine whether a t-test is appropriate. \r\n\r\nggplot(data = stems_y1, aes(x = stem_dry_mass)) +\r\n  geom_histogram(aes(fill = watershed)) +\r\n  facet_wrap(~ watershed) +\r\n  labs(x = \"Stem Mass (g)\", y = \"Count\")\r\n\r\n\r\n\r\nshow\r\n\r\nggplot(data = stems_y1, aes(sample = stem_dry_mass)) +\r\n  geom_qq(aes(color = watershed)) +\r\n  facet_wrap(~ watershed)\r\n\r\n\r\n\r\n\r\nThere is nothing in these visualizations to show that the data is not normally distributed. All of the visualizations show the presence of a few outlier values, but the majority of observations are clustered more closely together around the mean. Because of this, a t-test is appropriate to explore the difference in mean stem length between the treatment and control sites.\r\n\r\n\r\nshow\r\n\r\n# Run the t-test and Cohen's D \r\n\r\nstems_ref <- stems_y1 %>% \r\n  filter(watershed == \"Reference\") %>% \r\n  pull(stem_dry_mass)\r\n\r\nstems_w1 <- stems_y1 %>% \r\n  filter(watershed == \"W1\") %>% \r\n  pull(stem_dry_mass)\r\n\r\nstems_t <- t.test(stems_ref, stems_w1)\r\n\r\nstems_cohen <- cohen.d(stems_ref, stems_w1)\r\n\r\nmean_diff <- stems_summary[3, \"mean_mass\"] - stems_summary[1, \"mean_mass\"] \r\n\r\nmean_percent <- mean_diff / ((stems_summary[3, \"mean_mass\"] + stems_summary[1, \"mean_mass\"])/2)\r\n\r\n\r\n\r\nThe mean mass of stems on maples in the treatment watershed (0.033 \\(\\pm\\) 0.011 grams, n = 59; mean \\(\\pm\\) 1 standard deviation) is larger than that for reference watershed maples (0.023 \\(\\pm\\) 0.007 grams, n = 120; mean \\(\\pm\\) 1 standard deviation).\r\nThis gives an absolute difference in means between the treatment and reference watershed maples of 0.01 grams (or a 37 percent difference). The difference in mean stem mass between the treatment and reference maples included in this sample is significant (two-sample t-test: t(198= -9.18, p < .001. The effect size is large (Cohen’s d = -1.19).\r\nOverall, this does not prove that calcium treatment for watersheds impacted by acid rain increases the growth rate of sugar maples. It only proves that the difference in growth rates between the reference and treatment plots is significant. It is possible that other variables besides the treatment could contribute to this difference.\r\nData Source\r\nSugar maples data source: Juice, S. and T. Fahey. 2019. Health and mycorrhizal colonization response of sugar maple (Acer saccharum) seedlings to calcium addition in Watershed 1 at the Hubbard Brook Experimental Forest ver 3. Environmental Data Initiative. https://doi.org/10.6073/pasta/0ade53ede9a916a36962799b2407097e\r\n\r\n\r\n\r\n",
    "preview": "projects/sugar_maple/sugar_maple_files/figure-html5/unnamed-chunk-3-1.png",
    "last_modified": "2022-03-09T08:24:52-08:00",
    "input_file": {}
  }
]
